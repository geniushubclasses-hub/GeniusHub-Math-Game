<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<title>GeniusHub Math Game</title>

<style>
:root{
  --bg1:#cdeac0;
  --bg2:#d0cfff;
  --card:#ffffff;
  --accent:#ff7aa2;
  --accent2:#6ec6ff;
  --text:#123;
}

*{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}

body{
  margin:0;min-height:100vh;
  background:linear-gradient(180deg,var(--bg1),var(--bg2));
  display:flex;align-items:center;justify-content:center;
  padding:10px;color:var(--text);
}

.app{
  width:100%;max-width:540px;
  background:var(--card);
  border-radius:18px;padding:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.15);
}

/* HEADER */
header{text-align:center}
.logo{
  width:72px;height:72px;margin:0 auto 6px;
  border-radius:16px;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#fff;font-weight:900;
  display:flex;align-items:center;justify-content:center;
  font-size:14px;
}
h1{font-size:20px;margin:4px 0}
.lead{font-size:13px;color:#345}

/* SETUP */
.panel{margin-top:14px}
label{font-size:14px;font-weight:600}
input[type=text]{
  width:100%;padding:14px;font-size:18px;
  border-radius:12px;border:1px solid #ccc;margin-top:6px;
}

.levels{display:grid;grid-template-columns:1fr;gap:10px;margin-top:10px}
.level-btn{
  padding:14px;font-size:16px;border-radius:12px;
  border:2px dashed #ddd;background:#fff;font-weight:700;
}
.level-btn.active{border-color:var(--accent2);background:#f0f8ff}

button{
  border:none;border-radius:14px;
  font-size:18px;font-weight:800;
  padding:16px;touch-action:manipulation;
}
.start{
  background:linear-gradient(90deg,var(--accent),var(--accent2));
  color:white;width:100%;margin-top:12px;
}
.quit{
  background:#ffecec;color:#b00020;width:100%;margin-top:10px;
}

/* GAME */
.game{display:none;margin-top:16px}
.status{display:flex;flex-direction:column;gap:6px;font-size:14px}
.bar{
  width:100%;height:16px;background:#eaf0ff;
  border-radius:10px;overflow:hidden;
}
.bar i{
  display:block;height:100%;width:0%;
  background:linear-gradient(90deg,var(--accent),var(--accent2));
}
.question{
  margin-top:16px;background:#f7fbff;
  border-radius:14px;padding:18px;text-align:center;
}
.q-text{font-size:34px;font-weight:900;color:var(--accent2)}
.options{display:grid;grid-template-columns:1fr;gap:14px;margin-top:14px}
.opt{
  background:white;border:2px solid #ddd;
  border-radius:14px;padding:18px;
  font-size:22px;font-weight:800;
}
.opt.correct{background:#eaffea;border-color:limegreen}
.opt.wrong{background:#ffecec;border-color:#ff9aa2}

/* RESULT */
.result{display:none;text-align:center;padding:20px}
.score{font-size:38px;font-weight:900;color:var(--accent)}
.result-line{margin-top:6px;font-size:14px}
.small{margin-top:10px;background:#eef3ff;color:#123;width:100%}

@media (min-width:700px){
  .app{max-width:720px}
  .options{grid-template-columns:1fr 1fr}
}
</style>
</head>

<body>
<div class="app">

<header>
  <div class="logo">GeniusHub</div>
  <h1>GeniusHub Math Game</h1>
  <div class="lead">Oral Addition Practice</div>
</header>

<!-- SETUP -->
<div class="panel" id="setup">
  <label>Your Name</label>
  <input id="name" type="text" placeholder="Enter your name">

  <label style="margin-top:12px">Select Level</label>
  <div class="levels">
    <button class="level-btn active" data-level="1">1 digit + 1 digit</button>
    <button class="level-btn" data-level="2">2 digit + 1 digit</button>
    <button class="level-btn" data-level="3">2 digit + 2 digit</button>
    <button class="level-btn" data-level="4">3 digit + 2 digit</button>
    <button class="level-btn" data-level="5">3 digit + 3 digit</button>
  </div>

  <button class="start" id="startBtn">Start Game</button>
</div>

<!-- GAME -->
<div class="game" id="game">
  <div class="status">
    <div id="playerInfo"></div>
    <div class="bar"><i id="barFill"></i></div>
    <div id="counter"></div>
    <div id="timer"></div>
  </div>

  <div class="question">
    <div class="q-text" id="question"></div>
    <div class="options" id="options"></div>
  </div>

  <button class="quit" id="quitBtn">Quit Game</button>
</div>

<!-- RESULT -->
<div class="result" id="result">
  <div class="score" id="finalScore"></div>
  <div class="result-line" id="rName"></div>
  <div class="result-line" id="rLevel"></div>
  <div class="result-line" id="rAttempted"></div>
  <div class="result-line" id="rCorrect"></div>
  <div class="result-line" id="rTime"></div>
  <button class="start" id="playAgain">Play Again</button>
  <button class="small" id="home">Home</button>
</div>

</div>

<script>
const levels=document.querySelectorAll('.level-btn');
let level=1;

levels.forEach(b=>{
  b.onclick=()=>{
    levels.forEach(x=>x.classList.remove('active'));
    b.classList.add('active');
    level=+b.dataset.level;
  };
});

const rand=(a,b)=>Math.floor(Math.random()*(b-a+1))+a;

const gen=l=>{
  if(l===1) return [rand(0,9),rand(0,9)];
  if(l===2) return [rand(10,99),rand(0,9)];
  if(l===3) return [rand(10,99),rand(10,99)];
  if(l===4) return [rand(100,999),rand(10,99)];
  return [rand(100,999),rand(100,999)];
};

let questions=[],index=0,correct=0,startTime,name='';

function makeQuestions(){
  questions=[];
  for(let i=0;i<50;i++){
    const [a,b]=gen(level);
    questions.push({a,b,ans:a+b});
  }
}

function generateOptions(correct){
  const options=new Set();
  options.add(correct);

  // WRONG OPTION with SAME UNIT DIGIT
  const unit=correct%10;
  let sameUnit;
  do{
    sameUnit=(Math.floor(correct/10)+rand(1,9))*10+unit;
  }while(sameUnit===correct);
  options.add(sameUnit);

  // Other distractors
  while(options.size<4){
    let candidate=correct+rand(-20,20);
    if(candidate>0) options.add(candidate);
  }

  return [...options].sort(()=>Math.random()-0.5);
}

function startGame(){
  name=document.getElementById('name').value||'Player';
  document.getElementById('setup').style.display='none';
  document.getElementById('game').style.display='block';
  document.getElementById('playerInfo').textContent=`${name} | Level ${level}`;
  index=0;correct=0;startTime=Date.now();
  makeQuestions();
  nextQuestion();
}

function nextQuestion(){
  if(index>=questions.length){finishGame();return;}

  const q=questions[index];
  document.getElementById('question').textContent=`${q.a} + ${q.b} = ?`;
  document.getElementById('counter').textContent=`Question ${index+1} / 50`;
  document.getElementById('barFill').style.width=((index/50)*100)+'%';

  const opts=generateOptions(q.ans);
  const box=document.getElementById('options');
  box.innerHTML='';

  opts.forEach(v=>{
    const b=document.createElement('button');
    b.className='opt';b.textContent=v;
    b.onclick=()=>{
      if(v===q.ans){b.classList.add('correct');correct++;}
      else b.classList.add('wrong');
      setTimeout(()=>{index++;nextQuestion();},900);
    };
    box.appendChild(b);
  });

  document.getElementById('timer').textContent=
    'Time: '+new Date(Date.now()-startTime).toISOString().substr(14,5);
}

function finishGame(){
  document.getElementById('game').style.display='none';
  document.getElementById('result').style.display='block';

  const time=new Date(Date.now()-startTime).toISOString().substr(14,5);

  document.getElementById('finalScore').textContent=`${correct} / ${index}`;
  document.getElementById('rName').textContent=`Name: ${name}`;
  document.getElementById('rLevel').textContent=`Level: ${level}`;
  document.getElementById('rAttempted').textContent=`Attempted Questions: ${index}`;
  document.getElementById('rCorrect').textContent=`Correct Answers: ${correct}`;
  document.getElementById('rTime').textContent=`Time Taken: ${time}`;
}

document.getElementById('startBtn').onclick=startGame;
document.getElementById('quitBtn').onclick=finishGame;
document.getElementById('playAgain').onclick=()=>{document.getElementById('result').style.display='none';startGame();};
document.getElementById('home').onclick=()=>location.reload();
</script>

</body>
</html>
